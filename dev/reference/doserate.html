<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Dose Rate Estimation — doserate • gamma</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Dose Rate Estimation — doserate" />
<meta property="og:description" content="dose_fit builds a calibration curve for gamma dose rate estimation." />
<meta property="og:image" content="https://crp2a.github.io/gamma/logo.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@nfrerebeau" />
<meta name="twitter:site" content="@CRP2A" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gamma</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">1.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/gamma.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/doserate.html">Calibration Curve</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/crp2a/gamma/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Dose Rate Estimation</h1>
    <small class="dont-index">Source: <a href='https://github.com/crp2a/gamma/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/crp2a/gamma/blob/master/R/dose_fit.R'><code>R/dose_fit.R</code></a>, <a href='https://github.com/crp2a/gamma/blob/master/R/dose_predict.R'><code>R/dose_predict.R</code></a></small>
    <div class="hidden name"><code>doserate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>dose_fit</code> builds a calibration curve for gamma dose rate estimation.</p>
    </div>

    <pre class="usage"><span class='fu'>dose_fit</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>background</span>, <span class='va'>doses</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>dose_predict</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>spectrum</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for GammaSpectra,GammaSpectrum,matrix</span>
<span class='fu'>dose_fit</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>background</span>,
  <span class='va'>doses</span>,
  <span class='va'>range_Ni</span>,
  <span class='va'>range_NiEi</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.05</span>,
  details <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>authors <span class='op'>=</span> <span class='st'>""</span>, date <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># S4 method for GammaSpectra,GammaSpectrum,data.frame</span>
<span class='fu'>dose_fit</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>background</span>,
  <span class='va'>doses</span>,
  <span class='va'>range_Ni</span>,
  <span class='va'>range_NiEi</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.05</span>,
  details <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>authors <span class='op'>=</span> <span class='st'>""</span>, date <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># S4 method for CalibrationCurve,missing</span>
<span class='fu'>dose_predict</span><span class='op'>(</span><span class='va'>object</span>, sigma <span class='op'>=</span> <span class='fl'>1</span>, epsilon <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>

<span class='co'># S4 method for CalibrationCurve,GammaSpectrum</span>
<span class='fu'>dose_predict</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>spectrum</span>, sigma <span class='op'>=</span> <span class='fl'>1</span>, epsilon <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>

<span class='co'># S4 method for CalibrationCurve,GammaSpectra</span>
<span class='fu'>dose_predict</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>spectrum</span>, sigma <span class='op'>=</span> <span class='fl'>1</span>, epsilon <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A <a href='GammaSpectra-class.html'>GammaSpectra</a> or <a href='CalibrationCurve-class.html'>CalibrationCurve</a>
object.</p></td>
    </tr>
    <tr>
      <th>background</th>
      <td><p>A <a href='GammaSpectrum-class.html'>GammaSpectrum</a> object of a length-two
<code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> vector giving the background noise integration value
and error, respectively.</p></td>
    </tr>
    <tr>
      <th>doses</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></code> or <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code> TODO.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently not used.</p></td>
    </tr>
    <tr>
      <th>spectrum</th>
      <td><p>An optional <a href='GammaSpectrum-class.html'>GammaSpectrum</a> or
<a href='GammaSpectra-class.html'>GammaSpectra</a> object in which to look for variables with which
to predict. If omitted, the fitted values are used.</p></td>
    </tr>
    <tr>
      <th>range_Ni, range_NiEi</th>
      <td><p>A length-two <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> vector giving
the energy range to integrate within (in keV).</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> value giving the cutoff value for
confidence intervals (see <code><a href='https://rdrr.io/pkg/IsoplotR/man/york.html'>york</a></code>).</p></td>
    </tr>
    <tr>
      <th>details</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/list.html'>list</a></code> of length-one vector specifying
additional informations about the instrument for which the curve is built.</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> value giving TODO.</p></td>
    </tr>
    <tr>
      <th>epsilon</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> value giving an extra error term
introduced by the calibration of the energy scale of the spectrum.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>dose_fit</code> returns a <a href='CalibrationCurve-class.html'>CalibrationCurve</a> object.</p>
<p><code>dose_predict</code> returns a <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code> with the following
 columns:</p><dl>
  <dt>name</dt><dd><p>(<code><a href='https://rdrr.io/r/base/character.html'>character</a></code>) the name of the spectra.</p></dd>
  <dt>*_signal</dt><dd><p>(<code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code>) the integrated signal value
  (according to the value of <code>threshold</code>; see
  <code><a href='signal_integrate.html'>signal_integrate</a></code>).</p></dd>
  <dt>*_error</dt><dd><p>(<code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code>) the integrated signal error value
  (according to the value of <code>threshold</code>; see
  <code><a href='signal_integrate.html'>signal_integrate</a></code>).</p></dd>
  <dt>gamma_signal</dt><dd><p>(<code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code>) the predicted gamma dose rate.</p></dd>
  <dt>gamma_error</dt><dd><p>(<code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code>) the predicted gamma dose rate
  error.</p></dd>
 
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>dose_predict</code> predicts in situ gamma dose rate.</p>

<p>To estimate the gamma dose rate, one of the calibration curves distributed
 with this package can be used (fig. \@ref(fig:curve)). These built-in curves
 are in use in several luminescence dating laboratories and can be used to
 replicate published results. As these curves are instrument specific, the
 user may have to build its own curve.</p>
<p>The construction of a calibration curve requires a set of reference spectra
 for which the gamma dose rate is known and a background noise measurement.
 First, each reference spectrum is integrated over a given interval, then
 normalized to active time and corrected for background noise. The dose rate
 is finally modelled by the integrated signal value used as a linear
 predictor (York *et al.*, 2004).</p>
<p>See <code>vignette(doserate)</code> for a reproducible example.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Mercier, N. &amp; Falguères, C. (2007). Field Gamma Dose-Rate Measurement with
 a NaI(Tl) Detector: Re-Evaluation of the "Threshold" Technique.
 <em>Ancient TL</em>, 25(1), p. 1-4.</p>
<p>York, D., Evensen, N. M., Martínez, M. L. &amp; De Basabe Delgado, J. (2004).
 Unified Equations for the Slope, Intercept, and Standard Errors of the Best
 Straight Line. <em>American Journal of Physics</em>, 72(3), p. 367-75.
 DOI: <a href='https://doi.org/10.1119/1.1632486'>10.1119/1.1632486</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='signal_integrate.html'>signal_integrate</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>N. Frerebeau</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Import CNF files</span>
<span class='co'>## Spectra</span>
<span class='va'>spc_dir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/BDX_LaBr_1/calibration"</span>, package <span class='op'>=</span> <span class='st'>"gamma"</span><span class='op'>)</span>
<span class='va'>spc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.html'>read</a></span><span class='op'>(</span><span class='va'>spc_dir</span><span class='op'>)</span>

<span class='co'>## Background</span>
<span class='va'>bkg_dir</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"extdata/BDX_LaBr_1/background"</span>, package <span class='op'>=</span> <span class='st'>"gamma"</span><span class='op'>)</span>
<span class='va'>bkg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='read.html'>read</a></span><span class='op'>(</span><span class='va'>bkg_dir</span><span class='op'>)</span>

<span class='co'>## Get dose rate values</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"clermont"</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>doses</span> <span class='op'>&lt;-</span> <span class='va'>clermont</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"gamma_dose"</span>, <span class='st'>"gamma_error"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        gamma_dose gamma_error
#&gt; BRIQUE  1986.4620   35.619679
#&gt; C341     849.9668   21.317615
#&gt; C347    1423.8589   25.249756
#&gt; GOU     1575.2249   17.433789
#&gt; LAS     1083.6737    9.570593
#&gt; LMP      641.9004   17.560649
#&gt; MAZ     1141.4033   11.665045
#&gt; MPX      964.0196   13.274167
#&gt; PEP     2538.2217  112.169131</div><div class='input'>
<span class='co'>## Build the calibration curve</span>
<span class='va'>calib_curve</span> <span class='op'>&lt;-</span> <span class='fu'>dose_fit</span><span class='op'>(</span><span class='va'>spc</span>, <span class='va'>bkg</span>, <span class='va'>doses</span>,
                        range_Ni <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>300</span>, <span class='fl'>2800</span><span class='op'>)</span>,
                        range_NiEi <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>165</span>, <span class='fl'>2800</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## Plot the curve</span>
<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>calib_curve</span>, threshold <span class='op'>=</span> <span class='st'>"Ni"</span><span class='op'>)</span>
</div><div class='img'><img src='doserate-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Estimate gamma dose rates</span>
<span class='fu'>dose_predict</span><span class='op'>(</span><span class='va'>calib_curve</span>, <span class='va'>spc</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    names   dose_Ni error_Ni dose_NiEi error_NiEi
#&gt; 1 BRIQUE 1955.8683 43.87228 1946.9606   39.37700
#&gt; 2   C341  843.9938 21.12857  843.0632   17.05374
#&gt; 3   C347 1420.1912 34.31052 1402.5391   28.36931
#&gt; 4    GOU 1599.0175 37.47818 1598.6341   32.33417
#&gt; 5    LMP  640.1782 17.02795  639.0612   12.92859
#&gt; 6    MAZ 1140.4575 27.52632 1144.1496   23.14276
#&gt; 7    PEP 2443.3517 57.68531 2435.1440   49.25402</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nicolas Frerebeau, Brice Lebrun, Guilhem Paradol, <a href='https://www.u-bordeaux-montaigne.fr'><img src="https://crp2a.github.io/gamma/reference/figures/logo_ubm.jpg" height="64" /></a>, <a href='https://www.cnrs.fr'><img src="https://crp2a.github.io/gamma/reference/figures/logo_cnrs.jpg" height="64" /></a>, <a href='https://lascarbx.labex.u-bordeaux.fr'><img src="https://crp2a.github.io/gamma/reference/figures/logo_idex.png" height="80" /></a>, <a href='https://amidex.univ-amu.fr'><img src="https://crp2a.github.io/gamma/reference/figures/logo_amidex.jpg" height="48" /></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


